<div class="mainContainer">
  <h2>Backlog</h2>

  <div class="row">
    <div class="col-8">
      <ul class="list-group" dnd-sortable-container [sortableData]="backlogItems">
        <li *ngFor="let item of backlogItems; let i = index" class="list-group-item" dnd-sortable [sortableIndex]="i" (onDropSuccess)="updateOrder()">
          <div class="row">
            <div class="col-sm font-weight-bold">{{item.title}}</div>
            <div class="col-3">{{item.description | truncate: 15}}</div>
            <div class="col-1">{{item.estimation}}</div>
            <div class="col-2">
              <span class="badge badge-primary">{{item.status}}</span>
            </div>
            <div class="col-2">
              <button type="button" class="btn btn-sm fa fa-pencil-square-o " (click)="open(editModal,i)"></button>
              <button type="button" class="btn btn-sm fa fa fa-trash-o " (click)="remove(i)"></button>              
            </div>
          </div>
        </li>
      </ul>

      <ul>
        <li *ngFor="let item of backlogItems">
          {{item.title}}
        </li>
      </ul>
    </div>
    <p>
      <button class="btn" (click)="getBacklogItems()">Get Data</button>
      <br>
      <br>
      <button class="btn" (click)="open(newModal,0)">New Item</button>
    </p>

    <!-- MODAL EDIT BEGIN -->
    <ng-template #editModal let-c="close" let-d="dismiss">
      <div class="modal-header">
        <h4 class="modal-title">Edit Backlog Item</h4>
      </div>
      <div class="modal-body">
        <div class="form-group">
          <label for="bli-titel">Title</label>
          <input [(ngModel)]="backlogItems[selectedIndex].title" type="text" class="form-control" id="bli-titel" placeholder="Enter Title"
            name="bli-titel" required>
        </div>

        <div class="form-group">
          <label for="description">Description</label>
          <textarea [(ngModel)]="backlogItems[selectedIndex].description" type="text" class="form-control" id="description" placeholder="Description"
            name="description" required minlength="10"></textarea>
        </div>
        <!-- User Story start -->
        <div *ngIf="selectedIsUserstory()" class="form-group">
          <label for="sel1">Status</label>
          <select [(ngModel)]="backlogItems[selectedIndex].status" class="form-control" id="sel1">
            <option value="RFE">Ready for Estimation</option>
            <option value="RFS">Ready for Sprint</option>
          </select>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-primary" (click)="saveItem(selectedIndex)  ">Save</button>
        <button type="button" class="btn btn-outline-dark" (click)="c('Close click')">Close</button>
      </div>
    </ng-template>
    <!-- MODAL EDIT END -->


    <!-- MODAL NEW BEGIN -->
    <ng-template #newModal let-c="close" let-d="dismiss">
      <div class="modal-header">
        <h4 class="modal-title">New {{editMode}}</h4>
      </div>
      <div class="modal-body">
          <div class="btn-group form-group" data-toggle="buttons">
              <label class="btn btn-primary active">
                <input [(ngModel)]="editMode" type="radio" name="options" id="option1" (click)="editMode='whoop'" autocomplete="off" value="true" ngModel> User Story
              </label>
              <label class="btn btn-primary">
                <input [(ngModel)]="editMode" type="radio" name="options" id="option2" autocomplete="off" [value]="false"> Epic
              </label>
            </div>
        <div class="form-group">
          <label for="bli-titel">Title</label>
          <input [(ngModel)]="editMode" type="text" class="form-control" id="bli-titel" placeholder="Enter Title" name="bli-titel"
            required>
        </div>
      </div>


      <div class="modal-footer">
        <button type="button" class="btn btn-primary" (click)="saveItem(selectedIndex)">Save</button>
        <button type="button" class="btn btn-outline-dark" (click)="c('Close click')">Close</button>
      </div>
    </ng-template>

  </div>
</div>